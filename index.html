<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>송파AI 인구예보 - 통합 시스템</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary: #3b82f6;
            --secondary: #1e40af;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --purple: #8b5cf6;
            --text: #0f172a;
            --muted: #64748b;
            --bg: #f1f5f9;
            --card: #ffffff;
            --border: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
        }

        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* 헤더 */
        .main-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: var(--shadow-lg);
        }

        .main-title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .main-subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .live-indicator {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            background-color: var(--success);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
            margin-top: 1rem;
        }

        .live-dot {
            width: 6px;
            height: 6px;
            background-color: currentColor;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* 모드 선택 탭 */
        .mode-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .mode-tab {
            flex: 1;
            min-width: 200px;
            background: var(--card);
            border: 2px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .mode-tab:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .mode-tab.active {
            border-color: var(--primary);
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(30, 64, 175, 0.1));
        }

        .mode-tab .emoji {
            font-size: 1.5rem;
        }

        .mode-tab .tab-content {
            flex: 1;
        }

        .mode-tab .tab-title {
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 0.25rem;
        }

        .mode-tab .tab-desc {
            font-size: 0.75rem;
            color: var(--muted);
        }

        /* 대시보드 컨텐츠 */
        .dashboard-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .dashboard-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 메트릭 카드 */
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .metric-card {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary);
            transition: transform 0.2s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .metric-card.success { border-left-color: var(--success); }
        .metric-card.warning { border-left-color: var(--warning); }
        .metric-card.danger { border-left-color: var(--danger); }
        .metric-card.info { border-left-color: var(--info); }

        .metric-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .metric-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--muted);
            text-transform: uppercase;
        }

        .metric-icon {
            font-size: 1.5rem;
        }

        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .metric-change {
            font-size: 0.875rem;
            color: var(--muted);
        }

        .metric-change.positive { color: var(--success); }
        .metric-change.negative { color: var(--danger); }

        /* 차트 컨테이너 */
        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .chart-card {
            background: var(--card);
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: var(--shadow);
        }

        .chart-header {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border);
        }

        .chart-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .chart-subtitle {
            font-size: 0.875rem;
            color: var(--muted);
        }

        .chart-container {
            position: relative;
            height: 300px;
        }

        /* 테이블 */
        .data-table {
            width: 100%;
            background: var(--card);
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .data-table th {
            background: var(--bg);
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            font-size: 0.875rem;
            color: var(--muted);
            text-transform: uppercase;
        }

        .data-table td {
            padding: 1rem;
            border-top: 1px solid var(--border);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .status-badge.high {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .status-badge.medium {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning);
        }

        .status-badge.low {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        /* 반응형 */
        @media (max-width: 768px) {
            .main-title {
                font-size: 1.75rem;
            }

            .mode-tabs {
                flex-direction: column;
            }

            .mode-tab {
                min-width: 100%;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                height: 250px;
            }
            
            /* 상권 인사이트 패널 모바일 */
            #commercial-dashboard > div:first-child > div {
                grid-template-columns: 1fr !important;
            }
            
            /* 테이블 모바일 스크롤 */
            .data-table {
                font-size: 0.85rem;
            }
            
            @media (max-width: 640px) {
                .data-table {
                    display: block;
                    overflow-x: auto;
                    white-space: nowrap;
                }
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <!-- 메인 헤더 -->
        <header class="main-header">
            <h1 class="main-title">🚀 송파AI 인구예보</h1>
            <p class="main-subtitle">민간·공공 빅데이터 기반 실시간 AI분석 시스템</p>
            <div class="live-indicator">
                <span class="live-dot"></span>
                실시간 업데이트
            </div>
        </header>

        <!-- 모드 선택 탭 -->
        <div class="mode-tabs">
            <div class="mode-tab active" data-mode="parking">
                <span class="emoji">🅿️</span>
                <div class="tab-content">
                    <div class="tab-title">주차장</div>
                    <div class="tab-desc">실시간 주차장 혼잡도 분석</div>
                </div>
            </div>
            <div class="mode-tab" data-mode="density">
                <span class="emoji">👥</span>
                <div class="tab-content">
                    <div class="tab-title">밀집지</div>
                    <div class="tab-desc">생활활동 밀집지 혼잡도</div>
                </div>
            </div>
            <div class="mode-tab" data-mode="commercial">
                <span class="emoji">🏬</span>
                <div class="tab-content">
                    <div class="tab-title">상권</div>
                    <div class="tab-desc">유동인구 예측 기반 운영</div>
                </div>
            </div>
            <div class="mode-tab" data-mode="safety">
                <span class="emoji">🛟</span>
                <div class="tab-content">
                    <div class="tab-title">안전</div>
                    <div class="tab-desc">군중 밀집 위험 분석</div>
                </div>
            </div>
        </div>

        <!-- 주차장 대시보드 -->
        <div class="dashboard-content active" id="parking-dashboard">
            <div class="metrics-grid">
                <div class="metric-card success">
                    <div class="metric-header">
                        <span class="metric-title">전체 주차 가용률</span>
                        <span class="metric-icon">🅿️</span>
                    </div>
                    <div class="metric-value">67%</div>
                    <div class="metric-change positive">여유 · 1,245/3,720대 가능</div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-header">
                        <span class="metric-title">공영주차장</span>
                        <span class="metric-icon">🏛️</span>
                    </div>
                    <div class="metric-value">78%</div>
                    <div class="metric-change negative">혼잡 · 234/1,060대 가능</div>
                </div>
                <div class="metric-card info">
                    <div class="metric-header">
                        <span class="metric-title">민영주차장</span>
                        <span class="metric-icon">🏢</span>
                    </div>
                    <div class="metric-value">62%</div>
                    <div class="metric-change positive">보통 · 1,011/2,660대 가능</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">AI 예측 정확도</span>
                        <span class="metric-icon">🎯</span>
                    </div>
                    <div class="metric-value">94.5%</div>
                    <div class="metric-change">30분 후 예측 기준</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">주차장별 실시간 현황</h3>
                        <p class="chart-subtitle">송파구 주요 주차장 10곳</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="parkingStatusChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">시간대별 주차 예측</h3>
                        <p class="chart-subtitle">AI 기반 30분 단위 예측</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="parkingPredictionChart"></canvas>
                    </div>
                </div>
            </div>

            <table class="data-table">
                <thead>
                    <tr>
                        <th>주차장명</th>
                        <th>현재 상태</th>
                        <th>가용 주차면</th>
                        <th>30분 후 예측</th>
                        <th>요금</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>롯데월드 주차장</td>
                        <td><span class="status-badge high">혼잡</span></td>
                        <td>46/280대</td>
                        <td>34/280대</td>
                        <td>10분당 1,000원</td>
                    </tr>
                    <tr>
                        <td>석촌호수 공영</td>
                        <td><span class="status-badge low">여유</span></td>
                        <td>75/120대</td>
                        <td>68/120대</td>
                        <td>5분당 150원</td>
                    </tr>
                    <tr>
                        <td>송파구청 주차장</td>
                        <td><span class="status-badge medium">보통</span></td>
                        <td>32/110대</td>
                        <td>28/110대</td>
                        <td>5분당 100원</td>
                    </tr>
                    <tr>
                        <td>잠실역 환승주차장</td>
                        <td><span class="status-badge high">만차</span></td>
                        <td>0/450대</td>
                        <td>12/450대</td>
                        <td>일 5,000원</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 밀집지 대시보드 -->
        <div class="dashboard-content" id="density-dashboard">
            <div class="metrics-grid">
                <div class="metric-card danger">
                    <div class="metric-header">
                        <span class="metric-title">현재 유동인구</span>
                        <span class="metric-icon">👥</span>
                    </div>
                    <div class="metric-value">28,543</div>
                    <div class="metric-change positive">+12.5% 전시간 대비</div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-header">
                        <span class="metric-title">최고 밀집지역</span>
                        <span class="metric-icon">📍</span>
                    </div>
                    <div class="metric-value">롯데월드</div>
                    <div class="metric-change">8,234명/㎢</div>
                </div>
                <div class="metric-card success">
                    <div class="metric-header">
                        <span class="metric-title">한산 지역</span>
                        <span class="metric-icon">🌳</span>
                    </div>
                    <div class="metric-value">올림픽공원</div>
                    <div class="metric-change">423명/㎢</div>
                </div>
                <div class="metric-card info">
                    <div class="metric-header">
                        <span class="metric-title">이동 속도</span>
                        <span class="metric-icon">🚶</span>
                    </div>
                    <div class="metric-value">3.2km/h</div>
                    <div class="metric-change negative">혼잡 구간 평균</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">지역별 밀집도 현황</h3>
                        <p class="chart-subtitle">SKT 기지국 데이터 기반</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="densityAreaChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">시간대별 유동인구</h3>
                        <p class="chart-subtitle">오늘 vs 평균</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="densityTimeChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- 상권 대시보드 -->
        <div class="dashboard-content" id="commercial-dashboard">
            <!-- 상권 인사이트 패널 -->
            <div style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border: 1px solid #0284c7; border-radius: 12px; padding: 1.5rem; margin-bottom: 1.5rem;">
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
                    <div>
                        <h3 style="color: #0c4a6e; margin-bottom: 0.75rem; font-size: 1.1rem;">
                            👔 상인을 위한 AI 예측
                        </h3>
                        <ul style="color: #334155; font-size: 0.9rem; line-height: 1.8;">
                            <li>🎯 2시간 후 예상 고객: <strong style="color: #0284c7;">3,420명</strong> (+28%)</li>
                            <li>📈 피크 시간대: <strong>14:00-16:00</strong> 예상</li>
                            <li>💡 추천: 점심 시간대 직원 증원 필요</li>
                        </ul>
                    </div>
                    <div>
                        <h3 style="color: #0c4a6e; margin-bottom: 0.75rem; font-size: 1.1rem;">
                            🛍️ 고객을 위한 쾌적 시간대
                        </h3>
                        <ul style="color: #334155; font-size: 0.9rem; line-height: 1.8;">
                            <li>✨ 한산 예상: <strong style="color: #10b981;">10:00-11:00</strong> (쾌적)</li>
                            <li>⚡ 혼잡 예상: <strong style="color: #ef4444;">14:00-16:00</strong> (대기 필요)</li>
                            <li>🎁 추천: 오전 방문시 여유로운 쇼핑 가능</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="metrics-grid">
                <div class="metric-card success">
                    <div class="metric-header">
                        <span class="metric-title">현재 상권 유동인구</span>
                        <span class="metric-icon">🚶</span>
                    </div>
                    <div class="metric-value">12,845명</div>
                    <div class="metric-change positive">평년 대비 +15.3%</div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-header">
                        <span class="metric-title">최적 쇼핑 시간대</span>
                        <span class="metric-icon">⏰</span>
                    </div>
                    <div class="metric-value">10-11시</div>
                    <div class="metric-change">예상 대기시간 0분</div>
                </div>
                <div class="metric-card info">
                    <div class="metric-header">
                        <span class="metric-title">AI 예측 정확도</span>
                        <span class="metric-icon">🎯</span>
                    </div>
                    <div class="metric-value">92.8%</div>
                    <div class="metric-change positive">2시간 예측 기준</div>
                </div>
                <div class="metric-card">
                    <div class="metric-header">
                        <span class="metric-title">혼잡도 등급</span>
                        <span class="metric-icon">📊</span>
                    </div>
                    <div class="metric-value">보통</div>
                    <div class="metric-change">30분 후 '혼잡' 예상</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">🕐 시간대별 유동인구 예측</h3>
                        <p class="chart-subtitle">AI 기반 2시간 단위 예측 (상인 운영 가이드)</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="commercialPredictionChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">🏪 상권별 쾌적도 현황</h3>
                        <p class="chart-subtitle">실시간 혼잡도 & 대기시간 (고객 방문 가이드)</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="commercialComfortChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- 상권별 실시간 현황 테이블 -->
            <div style="margin-top: 1.5rem;">
                <h3 style="margin-bottom: 1rem; font-size: 1.2rem; font-weight: 600;">🏬 주요 상권 실시간 현황</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>상권명</th>
                            <th>현재 유동인구</th>
                            <th>혼잡도</th>
                            <th>예상 대기시간</th>
                            <th>2시간 후 예측</th>
                            <th>추천 방문시간</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>잠실역 지하상가</td>
                            <td>3,245명</td>
                            <td><span class="status-badge high">혼잡</span></td>
                            <td>15-20분</td>
                            <td>4,100명 (+26%)</td>
                            <td>오전 10-11시</td>
                        </tr>
                        <tr>
                            <td>롯데월드몰</td>
                            <td>5,432명</td>
                            <td><span class="status-badge medium">보통</span></td>
                            <td>5-10분</td>
                            <td>6,200명 (+14%)</td>
                            <td>오후 8-9시</td>
                        </tr>
                        <tr>
                            <td>석촌호수 카페거리</td>
                            <td>1,876명</td>
                            <td><span class="status-badge low">여유</span></td>
                            <td>대기 없음</td>
                            <td>2,300명 (+23%)</td>
                            <td>지금 방문 추천</td>
                        </tr>
                        <tr>
                            <td>송파 전통시장</td>
                            <td>2,292명</td>
                            <td><span class="status-badge low">여유</span></td>
                            <td>대기 없음</td>
                            <td>2,800명 (+22%)</td>
                            <td>오전 9-10시</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 안전 대시보드 -->
        <div class="dashboard-content" id="safety-dashboard">
            <div class="metrics-grid">
                <div class="metric-card danger">
                    <div class="metric-header">
                        <span class="metric-title">종합 위험지수</span>
                        <span class="metric-icon">⚠️</span>
                    </div>
                    <div class="metric-value">73/100</div>
                    <div class="metric-change negative">주의 단계</div>
                </div>
                <div class="metric-card warning">
                    <div class="metric-header">
                        <span class="metric-title">밀집 위험구역</span>
                        <span class="metric-icon">🚨</span>
                    </div>
                    <div class="metric-value">3개소</div>
                    <div class="metric-change">롯데월드, 잠실역, 석촌호수</div>
                </div>
                <div class="metric-card success">
                    <div class="metric-header">
                        <span class="metric-title">기상 상태</span>
                        <span class="metric-icon">🌤️</span>
                    </div>
                    <div class="metric-value">양호</div>
                    <div class="metric-change positive">맑음, 24°C</div>
                </div>
                <div class="metric-card info">
                    <div class="metric-header">
                        <span class="metric-title">대응 인력</span>
                        <span class="metric-icon">👮</span>
                    </div>
                    <div class="metric-value">42명</div>
                    <div class="metric-change">현장 배치 중</div>
                </div>
            </div>

            <div class="charts-grid">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">위험지수 추이</h3>
                        <p class="chart-subtitle">최근 24시간</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="safetyIndexChart"></canvas>
                    </div>
                </div>
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title">구역별 위험도</h3>
                        <p class="chart-subtitle">실시간 모니터링</p>
                    </div>
                    <div class="chart-container">
                        <canvas id="safetyZoneChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 전역 변수
        let charts = {};
        let currentMode = 'parking';

        // 모드 전환 함수
        function switchMode(mode) {
            currentMode = mode;
            
            // 탭 활성화 상태 변경
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.classList.toggle('active', tab.dataset.mode === mode);
            });
            
            // 대시보드 컨텐츠 변경
            document.querySelectorAll('.dashboard-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${mode}-dashboard`).classList.add('active');
            
            // 차트 초기화 (처음 방문시만)
            initializeCharts(mode);
        }

        // 차트 초기화 함수
        function initializeCharts(mode) {
            switch(mode) {
                case 'parking':
                    if (!charts.parkingStatus) {
                        createParkingCharts();
                    }
                    break;
                case 'density':
                    if (!charts.densityArea) {
                        createDensityCharts();
                    }
                    break;
                case 'commercial':
                    if (!charts.commercialPrediction) {
                        createCommercialCharts();
                    }
                    break;
                case 'safety':
                    if (!charts.safetyIndex) {
                        createSafetyCharts();
                    }
                    break;
            }
        }

        // 주차장 차트 생성
        function createParkingCharts() {
            // 주차장별 현황 차트
            const ctx1 = document.getElementById('parkingStatusChart').getContext('2d');
            charts.parkingStatus = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ['롯데월드', '석촌호수', '송파구청', '잠실역', '올림픽공원', '가든파이브', '문정역', '송파역', '방이역', '몽촌토성'],
                    datasets: [{
                        label: '사용중',
                        data: [234, 45, 78, 450, 224, 167, 89, 123, 67, 145],
                        backgroundColor: '#ef4444'
                    }, {
                        label: '가용',
                        data: [46, 75, 32, 0, 156, 113, 91, 77, 83, 105],
                        backgroundColor: '#10b981'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true },
                        y: { 
                            stacked: true,
                            title: { display: true, text: '주차면 수' }
                        }
                    }
                }
            });

            // 시간대별 예측 차트
            const ctx2 = document.getElementById('parkingPredictionChart').getContext('2d');
            charts.parkingPrediction = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: ['현재', '30분', '1시간', '1시간 30분', '2시간', '2시간 30분', '3시간'],
                    datasets: [{
                        label: '예측 가용률',
                        data: [67, 62, 58, 54, 48, 45, 52],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: '가용률 (%)' }
                        }
                    }
                }
            });
        }

        // 밀집지 차트 생성
        function createDensityCharts() {
            // 지역별 밀집도 차트
            const ctx1 = document.getElementById('densityAreaChart').getContext('2d');
            charts.densityArea = new Chart(ctx1, {
                type: 'bar',
                data: {
                    labels: ['롯데월드', '잠실역', '석촌호수', '송파역', '올림픽공원', '가든파이브', '문정역'],
                    datasets: [{
                        label: '현재 밀집도',
                        data: [8234, 6543, 4321, 3210, 423, 2345, 1876],
                        backgroundColor: [
                            '#ef4444', '#ef4444', '#f59e0b', '#f59e0b', '#10b981', '#3b82f6', '#3b82f6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            title: { display: true, text: '인구 밀도 (명/㎢)' }
                        }
                    }
                }
            });

            // 시간대별 유동인구 차트
            const ctx2 = document.getElementById('densityTimeChart').getContext('2d');
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
            charts.densityTime = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: hours,
                    datasets: [{
                        label: '오늘',
                        data: [800, 500, 300, 200, 300, 1200, 2000, 2800, 2400, 2000, 2200, 2800, 3200, 3000, 2600, 2400, 2200, 3000, 3800, 3400, 3000, 2400, 1600, 1000],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }, {
                        label: '평균',
                        data: [900, 600, 400, 300, 400, 1100, 1800, 2600, 2200, 1900, 2100, 2600, 3000, 2800, 2500, 2300, 2100, 2800, 3600, 3200, 2800, 2200, 1500, 1100],
                        borderColor: '#6b7280',
                        borderDash: [5, 5],
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            title: { display: true, text: '유동인구 (명)' }
                        }
                    }
                }
            });
        }

        // 상권 차트 생성
        function createCommercialCharts() {
            // 시간대별 유동인구 예측 차트
            const ctx1 = document.getElementById('commercialPredictionChart').getContext('2d');
            const currentHour = new Date().getHours();
            const labels = [];
            for(let i = 0; i < 12; i++) {
                const hour = (currentHour + i) % 24;
                labels.push(`${hour}:00`);
            }
            
            charts.commercialPrediction = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '예측 유동인구',
                        data: [2800, 3200, 3800, 4200, 4500, 4100, 3600, 3200, 2800, 2400, 2000, 1600],
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3
                    }, {
                        label: '평균 유동인구',
                        data: [2500, 2800, 3200, 3500, 3800, 3600, 3300, 3000, 2600, 2200, 1800, 1400],
                        borderColor: '#6b7280',
                        borderDash: [5, 5],
                        tension: 0.4,
                        borderWidth: 2
                    }, {
                        label: '혼잡 기준선',
                        data: [4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000, 4000],
                        borderColor: 'rgba(239, 68, 68, 0.5)',
                        borderDash: [10, 5],
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    if (context.dataset.label === '혼잡 기준선') {
                                        return '혼잡 기준: 4,000명';
                                    }
                                    
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += context.parsed.y.toLocaleString() + '명';
                                    
                                    // 혼잡도 표시
                                    if (context.parsed.y > 4000) {
                                        label += ' (매우 혼잡)';
                                    } else if (context.parsed.y > 3000) {
                                        label += ' (혼잡)';
                                    } else if (context.parsed.y > 2000) {
                                        label += ' (보통)';
                                    } else {
                                        label += ' (여유)';
                                    }
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        y: { 
                            beginAtZero: true,
                            max: 5000,
                            title: { display: true, text: '유동인구 (명)' }
                        }
                    }
                }
            });

            // 상권별 쾌적도 차트
            const ctx2 = document.getElementById('commercialComfortChart').getContext('2d');
            
            // 색상 배열 생성
            const bgColors = [3245, 5432, 1876, 2292, 1823, 1654].map(value => {
                if (value > 4000) return '#ef4444';  // 빨강 (혼잡)
                if (value > 3000) return '#f59e0b';  // 주황 (약간 혼잡)
                if (value > 2000) return '#3b82f6';  // 파랑 (보통)
                return '#10b981';  // 초록 (여유)
            });
            
            charts.commercialComfort = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['잠실역', '롯데월드몰', '석촌호수', '송파시장', '가든파이브', '문정역'],
                    datasets: [{
                        label: '현재 유동인구',
                        data: [3245, 5432, 1876, 2292, 1823, 1654],
                        backgroundColor: bgColors,
                        yAxisID: 'y'
                    }, {
                        label: '예상 대기시간(분)',
                        data: [18, 8, 0, 0, 3, 5],
                        backgroundColor: 'rgba(139, 92, 246, 0.5)',
                        borderColor: '#8b5cf6',
                        type: 'line',
                        borderWidth: 2,
                        yAxisID: 'y1'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    if (context.datasetIndex === 0) {
                                        const value = context.parsed.y;
                                        if (value > 4000) return '상태: 매우 혼잡 🔴';
                                        if (value > 3000) return '상태: 혼잡 🟠';
                                        if (value > 2000) return '상태: 보통 🔵';
                                        return '상태: 여유 🟢';
                                    }
                                    return '';
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            beginAtZero: true,
                            title: { display: true, text: '유동인구 (명)' }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            beginAtZero: true,
                            max: 30,
                            title: { display: true, text: '대기시간 (분)' },
                            grid: { drawOnChartArea: false }
                        }
                    }
                }
            });
        }

        // 안전 차트 생성
        function createSafetyCharts() {
            // 위험지수 추이 차트
            const ctx1 = document.getElementById('safetyIndexChart').getContext('2d');
            const hours = Array.from({length: 24}, (_, i) => `${i}:00`);
            charts.safetyIndex = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: hours,
                    datasets: [{
                        label: '위험지수',
                        data: [30, 25, 20, 15, 18, 35, 45, 58, 62, 65, 68, 72, 78, 73, 70, 68, 65, 70, 85, 80, 75, 65, 50, 40],
                        borderColor: '#ef4444',
                        backgroundColor: 'rgba(239, 68, 68, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { 
                            beginAtZero: true,
                            max: 100,
                            title: { display: true, text: '위험지수' }
                        }
                    }
                }
            });

            // 구역별 위험도 차트
            const ctx2 = document.getElementById('safetyZoneChart').getContext('2d');
            charts.safetyZone = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['롯데월드', '잠실역', '석촌호수', '송파역', '올림픽공원', '가든파이브'],
                    datasets: [{
                        label: '밀집 위험',
                        data: [85, 78, 72, 45, 20, 38],
                        backgroundColor: '#ef4444'
                    }, {
                        label: '교통 위험',
                        data: [70, 82, 45, 60, 15, 50],
                        backgroundColor: '#f59e0b'
                    }, {
                        label: '기상 위험',
                        data: [10, 10, 25, 10, 30, 10],
                        backgroundColor: '#3b82f6'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true },
                        y: { 
                            stacked: true,
                            max: 200,
                            title: { display: true, text: '위험도' }
                        }
                    }
                }
            });
        }

        // 실시간 데이터 업데이트 함수
        function updateRealTimeData() {
            // 여기에 실시간 데이터 업데이트 로직 추가
            console.log('실시간 데이터 업데이트:', new Date().toLocaleTimeString());
        }

        // 초기화
        document.addEventListener('DOMContentLoaded', function() {
            // 탭 클릭 이벤트
            document.querySelectorAll('.mode-tab').forEach(tab => {
                tab.addEventListener('click', () => {
                    switchMode(tab.dataset.mode);
                });
            });

            // 초기 차트 생성
            createParkingCharts();

            // 실시간 업데이트 시작 (5초마다)
            setInterval(updateRealTimeData, 5000);
        });
    </script>
</body>
</html>
